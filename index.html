<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://unpkg.com/mvp.css">
<style>
    /* both main and header tags have generous padding, it's too much */
    header, main, footer {
        padding-top: 1rem;
        padding-bottom: 1rem;
    }
</style>
<title>Daily workout generator</title>

<header>
    <h1>ðŸ¤¸ Daily Workout Generator ðŸ¤¸</h1>
    <p>Have little time and no inspiration? This can help.</p>
</header>

<main>
    <section>
        <form>
            <label>Equipment</label>
            <input type="checkbox" id="hasWeights" oninput="workout.print()">
            <label for="hasWeights">Weights</label>

            <input type="checkbox" id="hasBars" oninput="workout.print()">
            <label for="hasBars">Bars</label>

            <label>Time</label>
            <input type="range" id="minutes" min="5" max="30" step="5" value="15" oninput="workout.print()">

            <input type="button" onclick="workout.regenerate()" value="New workout">

            <div id="workout"></div>
            <div id="timer"></div>
        </form>
    </section>
</main>

<footer>
    <center>
        Made by <a href="https://tadas.blog" target="_blank">Tadas Paplauskas â†—</a>
    </center>
</footer>

<script>
function randomizeArray(items) {
    for (i = items.length; i > 0; i--) {
        j = Math.floor(Math.random() * i)
        k = items[i]
        items[i] = items[j]
        items[j] = k
    }

    return items
}

function last(items) {
    return items[items.length - 1]
}

const workout = {
    exercises: {
        bodyweight: {
            lower: [
                'Squats',
                'Single Leg Squats',
                'Lunges',
                'Side Lunges',
                'Front Kicks',
            ],
            push: [
                'Pushups',
                'Hindu Pushups',
                'Handstands',
            ],
            pull: [
                'Superman',
                'Swimmer',
                'Alternate Hand Raises',
            ],
            core: [
                'Scissors',
                'Walkouts',
                'Leg raises',
                'Plank',
            ],
        },
        weighted: {
            lower: [],
            push: [
                'Overhead Press',
                'Pushups with rows',
            ],
            pull: [
                'Swings',
                'Bent-over Rows',
            ],
            core: [
                'Orbits',
                'Rotations',
            ],
        },
        bars: {
            lower: [],
            push: [
                'Bar Pushups',
                'Dips',
                'L-dips',
            ],
            pull: [
                'Lateral Raises',
                'Pullups',
            ],
            core: [
                'Leg Raises',
            ],
        },
    },

    minutes: function() {
        return document.getElementById('minutes').value
    },

    hasWeights: function() {
        return document.getElementById('hasWeights').checked
    },

    hasBars: function() {
        return document.getElementById('hasBars').checked
    },

    regenerate: function() {
        this.randomize()
        this.print()
    },

    randomize: function () {
        ['bodyweight', 'weighted', 'bars'].forEach((equipment) => {
            ['lower', 'push', 'pull', 'core'].forEach((group) => {
                this.exercises[equipment][group] = randomizeArray(this.exercises[equipment][group])
            })
        })
    },

    selectExercises: function(minutes, hasWeights = false, hasBars = false) {
        var canDo = this.exercises.bodyweight

        if (hasWeights) {
            canDo = {
                lower: canDo.lower.concat(this.exercises.weighted.lower),
                push: canDo.push.concat(this.exercises.weighted.push),
                pull: canDo.pull.concat(this.exercises.weighted.pull),
                core: canDo.core.concat(this.exercises.weighted.core),
            }
        }

        if (hasBars) {
            canDo = {
                lower: canDo.lower.concat(this.exercises.bars.lower),
                push: canDo.push.concat(this.exercises.bars.push),
                pull: canDo.pull.concat(this.exercises.bars.pull),
                core: canDo.core.concat(this.exercises.bars.core),
            }
        }

        return [
            last(canDo.lower),
            last(canDo.push),
            last(canDo.pull),
            last(canDo.core),
            '1 minute rest',
            minutes > 5 ? `Repeat ${minutes / 5 - 1} more times` : `Done!`,
            minutes > 5 ?  `For a total of ${minutes} minutes` : null,
        ].filter(x => x)
    },

    print: function() {
        const lines = this.selectExercises(this.minutes(), this.hasWeights(), this.hasBars())

        for (let i = 0; i < 4; i++)
            lines[i] = `<a href="https://www.youtube.com/results?search_query=${encodeURIComponent(lines[i] + ' exercise')}" target="_blank">${lines[i]}</a>`

        document.getElementById('workout').innerHTML = `
        <small>Do as many repetitions as you can.</small>
        <ul id="list">
            <li>
                ${lines.join('</li><li>')}
            </li>
        </ul>`
    },
}
workout.regenerate()
</script>

